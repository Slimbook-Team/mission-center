{
  "app-id": "mc.build.env",
  "runtime": "org.gnome.Sdk",
  "runtime-version": "45",
  "sdk": "org.gnome.Sdk",
  "command": "fish",
  "sdk-extensions": [
    "org.freedesktop.Sdk.Extension.rust-stable"
  ],
  "build-options": {
    "append-path": "/usr/lib/sdk/rust-stable/bin"
  },
  "finish-args": [
    "--share=network",
    "--share=ipc",
    "--device=dri",
    "--socket=wayland",
    "--socket=x11",
    "--socket=ssh-auth",
    "--socket=session-bus",
    "--socket=system-bus",
    "--filesystem=host",
    "--filesystem=xdg-run/gvfsd",
    "--filesystem=xdg-run/keyring",
    "--filesystem=~/.local/share/flatpak",
    "--filesystem=xdg-data/meson",
    "--filesystem=/var/lib/flatpak",
    "--talk-name=org.freedesktop.Flatpak",
    "--talk-name=org.gtk.vfs.*",
    "--talk-name=org.freedesktop.FileManager1",
    "--system-talk-name=org.freedesktop.PolicyKit1",
    "--allow=devel",
    "--env=PATH=/app/bin:/usr/bin:/usr/lib/sdk/rust-stable/bin"
  ],
  "cleanup": [
  ],
  "modules": [
    {
      "name": "fish",
      "buildsystem": "cmake-ninja",
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/fish-shell/fish-shell/releases/download/3.6.1/fish-3.6.1.tar.xz",
          "sha256": "55402bb47ca6739d8aba25e41780905b5ce1bce0a5e0dd17dca908b5bc0b49b2"
        }
      ],
      "cleanup": [
        "/include",
        "*.a",
        "*.la"
      ]
    },
    {
      "name": "musl-libc",
      "buildsystem": "autotools",
      "config-opts": [
        "--prefix=/app/musl-libc"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://musl.libc.org/releases/musl-1.2.3.tar.gz",
          "sha256": "7d5b0b6062521e4627e099e4c9dc8248d32a30285e959b7eecaa780cf8cfd4a4"
        }
      ],
      "cleanup": [
        "*"
      ]
    },
    {
      "name": "dmidecode",
      "buildsystem": "simple",
      "build-commands": [
        "make CC=/app/musl-libc/bin/musl-gcc CFLAGS=\"-static -I/app/musl-libc/include\" LDFLAGS=\"-static -L/app/musl-libc/lib\" install-bin prefix=/app",
        "install -v -p -m 755 /app/sbin/dmidecode /app/bin/dmidecode"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://git.savannah.nongnu.org/cgit/dmidecode.git/snapshot/dmidecode-3-5.tar.gz",
          "sha256": "8b1465a1afa71f9ffb0206ba5ffc435c46c0281d089552578f600879728a1b23"
        }
      ]
    },
    {
      "name": "neovim",
      "buildsystem": "simple",
      "build-commands": [
        "mkdir -p /app",
        "cp -ar bin/* /app/bin/"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/neovim/neovim/releases/download/stable/nvim-linux64.tar.gz",
          "sha256": "dbf4eae83647ca5c3ce1cd86939542a7b6ae49cd78884f3b4236f4f248e5d447"
        }
      ]
    },
    {
      "name": "libfuse",
      "config-opts": [
        "UDEV_RULES_PATH=/app/etc/udev/rules.d",
        "INIT_D_PATH=/app/etc/init.d",
        "MOUNT_FUSE_PATH=/app/sbin"
      ],
      "cleanup": [
        "/bin/ulockmgr_server"
      ],
      "post-install": [
        "install -m a+rx fusermount-wrapper.sh /app/bin/fusermount"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/libfuse/libfuse/releases/download/fuse-2.9.9/fuse-2.9.9.tar.gz",
          "sha256": "d0e69d5d608cc22ff4843791ad097f554dd32540ddc9bed7638cc6fea7c1b4b5"
        },
        {
          "type": "patch",
          "path": "fuse-2.9.2-namespace-conflict-fix.patch"
        },
        {
          "type": "patch",
          "path": "fuse-disable-sys-mount-under-flatpak.patch"
        },
        {
          "type": "patch",
          "path": "fuse-2.9.2-closefrom.patch"
        },
        {
          "type": "file",
          "path": "fusermount-wrapper.sh"
        }
      ]
    },
    {
      "name": "ostree",
      "config-opts": [
        "--disable-man",
        "--with-curl",
        "--without-soup",
        "--without-libsystemd"
      ],
      "cleanup": [
        "/bin",
        "/etc/grub.d",
        "/etc/ostree",
        "/share/ostree",
        "/libexec"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/ostreedev/ostree.git",
          "tag": "v2023.6"
        }
      ]
    },
    {
      "name": "libyaml",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/yaml/libyaml.git",
          "tag": "0.2.5"
        }
      ]
    },
    {
      "name": "libxmlb",
      "config-opts": [
        "--libdir=/app/lib",
        "--buildtype=release",
        "-Dgtkdoc=false",
        "-Dintrospection=false",
        "-Dtests=false",
        "-Dcli=false"
      ],
      "buildsystem": "meson",
      "builddir": true,
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/hughsie/libxmlb.git",
          "tag": "0.3.8"
        }
      ]
    },
    {
      "name": "libstemmer",
      "buildsystem": "cmake-ninja",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/zvelo/libstemmer",
          "tag": "78c149a3a6f262a35c7f7351d3f77b725fc646cf"
        }
      ]
    },
    {
      "name": "flatpak-builder",
      "buildsystem": "meson",
      "config-opts": [
        "-Ddocs=disabled",
        "-Dtests=false"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/flatpak/flatpak-builder.git",
          "tag": "1.3.3"
        }
      ]
    }
  ]
}
